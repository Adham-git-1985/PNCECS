/* Lightweight bootstrap for PDF.js worker.
   Place this file at: static/vendor/pdfjs/pdf.worker.min.js
   It will try to import a local full worker first (pdf.worker.local.js), then fallback to CDN.
   Version target: PDF.js 3.10.177
*/
(function(){
  function tryImport(url){
    try { importScripts(url); return true; } catch(e){ /* console.error('importScripts failed for', url, e); */ return false; }
  }

  // 1) Try a local full worker if you've downloaded it as pdf.worker.local.js
  if (tryImport(self.location.origin + '/static/vendor/pdfjs/pdf.worker.local.js')) {
    // Loaded local full worker successfully
    return;
  }

  // 2) Try relative local (works when served under subpaths / dev environments)
  if (tryImport('/static/vendor/pdfjs/pdf.worker.local.js')) { return; }

  // 3) Fallback to CDN
  if (tryImport('https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.10.177/pdf.worker.min.js')) {
    return;
  }

  // 4) If everything fails, notify main thread (won't render but gives a hint)
  try { self.postMessage({ type: 'PDFJS_WORKER_LOAD_ERROR', error: 'Failed to load PDF.js worker from both local and CDN.' }); } catch(_) {}
})();