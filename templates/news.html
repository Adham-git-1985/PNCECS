{% extends "layout.html" %}
{% block title %}{{ 'News - PNCECS' if (g.lang=='en') else 'ุงูุฃุฎุจุงุฑ - ุงููุฌูุฉ ุงููุทููุฉ' }}{% endblock %}

{% block content %}
{% set lang = g.lang or 'ar' %}
<div class="container my-5">
    <h2 class="mb-4 text-primary text-center">๐ฐ {{ 'News' if lang=='en' else 'ุงูุฃุฎุจุงุฑ' }}</h2>

    <form method="GET" class="mb-4">
        <div class="row g-2">
            <div class="col-sm-9">
                <input
                    type="text"
                    name="q"
                    class="form-control"
                    placeholder="{{ 'Search newsโฆ' if lang=='en' else '๐ ุงุจุญุซ ูู ุงูุฃุฎุจุงุฑ...' }}"
                    value="{{ query }}"
                >
            </div>
            <div class="col-sm-3">
                <button type="submit" class="btn btn-primary w-100">{{ 'Search' if lang=='en' else 'ุจุญุซ' }}</button>
            </div>
        </div>
    </form>

    <div class="row row-cols-1 row-cols-md-2 g-4">
        {% for item in news_list %}
        <div class="col">
            <div class="card h-100">
                {# ููุงุญุธุฉ: ูู ุจุนุถ ุงููุดุงุฑูุน ูุฑุชุจุท ุงูุฎุจุฑ ุจุตูุฑ ุนุจุฑ ุนูุงูุฉ item.gallery.
                   ุฅู ูู ุชูู ุงูุนูุงูุฉ ููุฌูุฏุฉ ูุฏููุ ูุงูุณุทุฑ ุงูุชุงูู ุณูุชุฌุงูู ุฐูู ุจุฃูุงู. #}
                {% set image = (item.gallery[0] if (item.gallery is defined and item.gallery) else None) %}
                {% if image %}
                <img
                    src="{{ url_for('static', filename='images/gallery/' ~ image.filename) }}"
                    class="card-img-top"
                    alt="{{ image.title or ('Image' if lang=='en' else 'ุตูุฑุฉ') }}"
                >
                {% endif %}
                <div class="card-body">
                    {# ุงูุนููุงู ูุงููุญุชูู: app.py ูููู ุจุชูุฑูุฑ ุงููุณุฎุฉ ุงูุฅูุฌููุฒูุฉ ูุคูุชูุง ุนูุฏ lang=='en',
                       ูุฐูู ูููู ุงุณุชุฎุฏุงู item.title/item.content ููุง. #}
                    <h5 class="card-title">{{ item.title }}</h5>
                    <p class="card-text">{{ item.content[:180] }}...</p>
                    <a
                        href="{{ url_for('news_detail', news_id=item.id) }}"
                        class="btn btn-outline-primary btn-sm" target="_blank" rel="noopener noreferrer"
                    >
                        {{ 'Read more' if lang=='en' else 'ูุฑุงุกุฉ ุงูุฎุจุฑ' }}
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    {% if pages > 1 %}
    <nav class="mt-4">
        <ul class="pagination justify-content-center flex-wrap">
            {# ุฒุฑ ุงูุตูุญุฉ ุงูุณุงุจูุฉ #}
            <li class="page-item {% if page <= 1 %}disabled{% endif %}">
                <a
                    class="page-link"
                    href="?page={{ page-1 }}{% if query %}&q={{ query }}{% endif %}"
                    aria-label="{{ 'Previous' if lang=='en' else 'ุงูุณุงุจู' }}"
                >
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>

            {# ุนุฑุถ ุงูุฃุฑูุงู ูุน ููุงุท ูุณุทูุฉ #}
            {% if pages <= 7 %}
                {% for p in range(1, pages + 1) %}
                <li class="page-item {% if p == page %}active{% endif %}">
                    <a
                        class="page-link"
                        href="?page={{ p }}{% if query %}&q={{ query }}{% endif %}"
                    >
                        {{ p }}
                    </a>
                </li>
                {% endfor %}
            {% else %}
                {% for p in range(1, pages + 1) %}
                    {% if p <= 5 or p > pages - 2 %}
                        <li class="page-item {% if p == page %}active{% endif %}">
                            <a
                                class="page-link"
                                href="?page={{ p }}{% if query %}&q={{ query }}{% endif %}"
                            >
                                {{ p }}
                            </a>
                        </li>
                    {% elif p == 6 %}
                        <li class="page-item disabled">
                            <span class="page-link">&hellip;</span>
                        </li>
                    {% endif %}
                {% endfor %}
            {% endif %}

            {# ุฒุฑ ุงูุตูุญุฉ ุงูุชุงููุฉ #}
            <li class="page-item {% if page >= pages %}disabled{% endif %}">
                <a
                    class="page-link"
                    href="?page={{ page+1 }}{% if query %}&q={{ query }}{% endif %}"
                    aria-label="{{ 'Next' if lang=='en' else 'ุงูุชุงูู' }}"
                >
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
    {% endif %}
</div>
{% endblock %}
